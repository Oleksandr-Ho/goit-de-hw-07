# Опис роботи DAG "oholodetskyi_medal_count_dag"

## Загальний опис

DAG виконує такі завдання:

1. **Створення таблиці результатів.**
2. **Вибір випадкового типу медалі** (“Bronze”, “Silver”, “Gold”).
3. **Розгалуження логіки виконання завдань** залежно від обраного типу медалі.
4. **Обчислення кількості медалей** у таблиці результатів для відповідного типу.
5. **Додавання затримки** перед виконанням сенсора для перевірки.
6. **Перевірка коректності** запису в таблицю результатів за допомогою сенсора.

---

## Сценарії виконання та скріншоти

### Успішний сценарій
- **Затримка**: `time.sleep(15)`.
- **Таймаут сенсора**: `timeout=31`.
- Усі завдання виконуються успішно, сенсор підтверджує коректність запису.

### Невдалий сценарій
- **Затримка**: `time.sleep(35)`.
- **Таймаут сенсора**: `timeout=31`.
- Завдання `check_for_correctness` завершується з помилкою, оскільки запис у таблицю відбувається пізніше ніж через 31 секунду.

---

## Скриншоти виконання

### Виконання DAG при різних сценаріях
![DAG timeout 31.PNG](DAG%20timeout%2031.PNG)

### Таблиця `oholodetskyi_medal_count` після виконання DAG:

Таблиця містить записи про тип медалі, кількість та час створення запису.
![DB oholodetskyi_medal_count.PNG](DB%20oholodetskyi_medal_count.PNG)

